---
import { getCollection, render } from 'astro:content';
import { Image } from 'astro:assets';

import BaseLayout from '../layouts/base-layout.astro';

// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  // Define the collection
  const pages = await getCollection('pages');
  // Return an array with the paths and props for each entry
  return pages.map(page => ({
    params: { slug: page.slug },
    props: { page },
  }));
}
// 2. Get the entry directly from the prop
const { page } = Astro.props;
const { Content } = await render(page);

// Format page meta title and description
const metaTitleUnformatted = page.data.metaTitle ?? page.data.title;
const metaTitleFormatted = metaTitleUnformatted + " | Sim Seneca";
const metaDescription = page.data.metaDescription ?? page.data.intro;

---

<BaseLayout
  metaTitle={metaTitleFormatted}
	title={page.data.title}
  description={metaDescription}
  collection='pages'
>
  <section class="standard-wrapper u-mrg-be-3xl">
    <div class="u-container">
      <div class="standard-inner">
        <div class="standard-intro u-pad-bs-3xl u-pad-be-2xl">
          <h1>/ {page.data.title}</h1>
          <h2 class="u-font-display u-fontsize-3">
            {page.data.intro}
          </h2>
          Updated: {page.data.updated}
        </div>
        <div class="standard-content u-wysiwyg">
          <Content />
        </div>        
      </div>
    </div>      
  </section>
</BaseLayout>