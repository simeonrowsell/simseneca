---
import { getCollection, render } from 'astro:content';
import { Image } from 'astro:assets';

import BaseLayout from '../layouts/base-layout.astro';

// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  // Define the collection
  const pages = await getCollection('pages');
  // Return an array with the paths and props for each entry
  return pages.map(page => ({
    params: { slug: page.slug },
    props: { page },
  }));
}
// 2. Get the entry directly from the prop
const { page } = Astro.props;
const { Content } = await render(page);

// Format page meta title and description
const metaTitleUnformatted = page.data.metaTitle ?? page.data.title;
const metaTitleFormatted = metaTitleUnformatted + " | Sim Seneca";
const metaDescription = page.data.metaDescription ?? page.data.intro;

---

<BaseLayout
  metaTitle={metaTitleFormatted}
	title={page.data.title}
  description={metaDescription}
  collection='pages'
>
  <section class="standard-wrapper u-mrg-be-3xl">
    <div class="u-container">
      <div class="standard-inner">
        <div class="standard-intro u-pad-bs-3xl u-pad-be-2xl">
          <h1 class="u-pad-be-2xs">/ {page.data.title}</h1>
          <h2 class="u-fontsize-4 u-pad-be-m">
            {page.data.intro}
          </h2>
          <p class="updated u-subtitle">Updated: {page.data.updated}</p>
        </div>
        <div class="standard-content u-wysiwyg">
          <Content />
        </div>        
      </div>
    </div>      
  </section>
</BaseLayout>

<style>

  .standard-inner {
    --content-left-padding: 0;
    --max-content-width: min(800px, 100%);    

    @media (min-width: 400px) {
      --content-left-padding: var(--space-m);
    }

    @media (min-width: 700px) {
      --content-left-padding: var(--space-xl);
    }

    @media (min-width: 1000px) {
      --content-left-padding: var(--space-2xl);
    }
  }

  .standard-intro {
    color: var(--accent-2);
    padding-inline-start: var(--content-left-padding);
    max-width: var(--max-content-width);

    @media (min-width: 400px) {
      border-inline-start: 2px solid var(--border-primary);
    }

    h2 {
      text-wrap: pretty;
    }

    .updated {
      color: var(--text-secondary);
    }
  }

</style>